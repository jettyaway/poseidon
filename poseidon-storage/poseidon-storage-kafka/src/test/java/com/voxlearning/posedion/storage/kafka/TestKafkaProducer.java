package com.voxlearning.posedion.storage.kafka;

import com.voxlearning.poseidon.settings.dialect.Props;
import com.voxlearning.poseidon.storage.kafka.KafkaProducer;
import com.voxlearning.poseidon.storage.kafka.callback.SinkCallback;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.ArrayList;
import java.util.List;

/**
 * @author <a href="mailto:hao.su@17zuoye.com">hao.su</a>
 * @version 2017-12-27
 * @since 17-12-27
 */
public class TestKafkaProducer {
    private Logger logger = LoggerFactory.getLogger(TestKafkaProducer.class);

    private KafkaProducer producer;

    private List<byte[]> message;

    @Before
    public void init() {
        producer = new KafkaProducer(new Props("kafka.properties"));
        message = new ArrayList<>();
        String line = "{\"_l\":\"alert\",\"_lv\":6,\"_type\":\"2\",\"app\":\"17homework_ReciteSentence\",\"app_type\":\"AppStore\",\"client_ip\":\"223.88.29.97\",\"etc\":\"{\\\"info\\\":\\\"{\\\\\\\"question\\\\\\\":{\\\\\\\"indexP\\\\\\\":-1,\\\\\\\"indexR\\\\\\\":-1,\\\\\\\"seq\\\\\\\":-1,\\\\\\\"item_id\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"skipSeq\\\\\\\":false,\\\\\\\"result\\\\\\\":{\\\\\\\"questionId\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"finishTime\\\\\\\":0,\\\\\\\"isCorrect\\\\\\\":null,\\\\\\\"fullScore\\\\\\\":0,\\\\\\\"score\\\\\\\":0,\\\\\\\"subQuestionResults\\\\\\\":[],\\\\\\\"isDone\\\\\\\":false,\\\\\\\"photoPictures\\\\\\\":[],\\\\\\\"correctness\\\\\\\":\\\\\\\"unfinished\\\\\\\",\\\\\\\"comment\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"isRight\\\\\\\":-2},\\\\\\\"hIndex\\\\\\\":-1,\\\\\\\"pIndex\\\\\\\":-1,\\\\\\\"questionAnalysis\\\\\\\":null,\\\\\\\"picUploadLimit\\\\\\\":0,\\\\\\\"rawData\\\\\\\":{\\\\\\\"id\\\\\\\":\\\\\\\"Q_10304365781566-3\\\\\\\",\\\\\\\"subjectId\\\\\\\":103,\\\\\\\"knowledgePoints\\\\\\\":[],\\\\\\\"knowledgePointsNew\\\\\\\":[],\\\\\\\"testMethods\\\\\\\":null,\\\\\\\"solutionMethods\\\\\\\":null,\\\\\\\"resourceIds\\\\\\\":null,\\\\\\\"resourceIndex\\\\\\\":0,\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":null,\\\\\\\"listenSeconds\\\\\\\":0,\\\\\\\"exploreSeconds\\\\\\\":null,\\\\\\\"answersSeconds\\\\\\\":null,\\\\\\\"paperIds\\\\\\\":null,\\\\\\\"books\\\\\\\":null,\\\\\\\"booksNew\\\\\\\":[{\\\\\\\"seriesId\\\\\\\":\\\\\\\"BKC_10300102937328\\\\\\\",\\\\\\\"bookId\\\\\\\":\\\\\\\"BK_10300000722738\\\\\\\",\\\\\\\"unitId\\\\\\\":\\\\\\\"BKC_10300040081794\\\\\\\",\\\\\\\"lessonId\\\\\\\":\\\\\\\"BKC_10300040084602\\\\\\\",\\\\\\\"sectionId\\\\\\\":null,\\\\\\\"termType\\\\\\\":1,\\\\\\\"classLevel\\\\\\\":2}],\\\\\\\"contentTypeId\\\\\\\":1032000,\\\\\\\"contentType2Id\\\\\\\":1032010,\\\\\\\"difficultyInt\\\\\\\":1,\\\\\\\"description\\\\\\\":\\\\\\\"全文朗读\\\\\\\",\\\\\\\"notFitMobile\\\\\\\":0,\\\\\\\"seconds\\\\\\\":23,\\\\\\\"complex\\\\\\\":0,\\\\\\\"nid\\\\\\\":null,\\\\\\\"lastEditorId\\\\\\\":null,\\\\\\\"finalAuditorId\\\\\\\":null,\\\\\\\"roughAuditorIds\\\\\\\":null,\\\\\\\"content\\\\\\\":{\\\\\\\"content\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"contentDesc\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"analysis\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"subContents\\\\\\\":[{\\\\\\\"content\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"answers\\\\\\\":[],\\\\\\\"subContentTypeId\\\\\\\":14,\\\\\\\"analysis\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"optionType\\\\\\\":\\\\\\\"word\\\\\\\",\\\\\\\"options\\\\\\\":[],\\\\\\\"hideOptionNumber\\\\\\\":0,\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"listenSeconds\\\\\\\":0,\\\\\\\"exploreSeconds\\\\\\\":null,\\\\\\\"answersSeconds\\\\\\\":null,\\\\\\\"oralDict\\\\\\\":{\\\\\\\"seconds\\\\\\\":null,\\\\\\\"variables\\\\\\\":null,\\\\\\\"keywords\\\\\\\":null,\\\\\\\"options\\\\\\\":[{\\\\\\\"name\\\\\\\":null,\\\\\\\"text\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"seconds\\\\\\\":10,\\\\\\\"roleType\\\\\\\":null,\\\\\\\"cnText\\\\\\\":null,\\\\\\\"voiceText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"voiceTexts\\\\\\\":null,\\\\\\\"sentencePatterns\\\\\\\":null,\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":\\\\\\\"57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenSeconds\\\\\\\":\\\\\\\"2\\\\\\\",\\\\\\\"dialogRole\\\\\\\":null,\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"listenFile\\\\\\\":null,\\\\\\\"jsgf\\\\\\\":null,\\\\\\\"voiceStart\\\\\\\":null,\\\\\\\"voiceEnd\\\\\\\":null}],\\\\\\\"voiceText\\\\\\\":null,\\\\\\\"sentencePatterns\\\\\\\":null,\\\\\\\"picUrl\\\\\\\":null,\\\\\\\"picName\\\\\\\":null,\\\\\\\"beginListenUrl\\\\\\\":null,\\\\\\\"endListenUrl\\\\\\\":null,\\\\\\\"scorePercentage\\\\\\\":null,\\\\\\\"readySeconds\\\\\\\":null,\\\\\\\"listenFile\\\\\\\":null,\\\\\\\"contentDesc\\\\\\\":null,\\\\\\\"answers\\\\\\\":null,\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"jsgf\\\\\\\":null,\\\\\\\"videoUrl\\\\\\\":null,\\\\\\\"videoCoverUrl\\\\\\\":null,\\\\\\\"highlightPos\\\\\\\":null},\\\\\\\"submitWays\\\\\\\":[3],\\\\\\\"tags\\\\\\\":null,\\\\\\\"analysisList\\\\\\\":null,\\\\\\\"pictureUrl\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"extras\\\\\\\":{},\\\\\\\"tagsDesc\\\\\\\":[]}]},\\\\\\\"docId\\\\\\\":\\\\\\\"Q_10304365781566\\\\\\\",\\\\\\\"version\\\\\\\":3,\\\\\\\"wordId\\\\\\\":null,\\\\\\\"pictureUrl\\\\\\\":null,\\\\\\\"tagId\\\\\\\":null,\\\\\\\"createdAt\\\\\\\":1492495291744,\\\\\\\"deletedAt\\\\\\\":null,\\\\\\\"olCreatedAt\\\\\\\":1492497588988,\\\\\\\"olUpdatedAt\\\\\\\":1492497588988,\\\\\\\"sentenceIds\\\\\\\":[218300240008011],\\\\\\\"sentenceContents\\\\\\\":[{\\\\\\\"sentenceId\\\\\\\":218300240008011,\\\\\\\"dialogRole\\\\\\\":\\\\\\\"Girl\\\\\\\",\\\\\\\"data\\\\\\\":{\\\\\\\"foreignText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"nativeText\\\\\\\":\\\\\\\"我需要一条新连衣裙。\\\\\\\",\\\\\\\"voiceText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"audioUrl\\\\\\\":\\\\\\\"/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"audioTime\\\\\\\":1805,\\\\\\\"type\\\\\\\":0}}],\\\\\\\"practiceTypeIds\\\\\\\":[91],\\\\\\\"categoryId\\\\\\\":10303,\\\\\\\"fromId\\\\\\\":9,\\\\\\\"paragraph\\\\\\\":null,\\\\\\\"articleName\\\\\\\":null,\\\\\\\"descriptionFile\\\\\\\":null,\\\\\\\"analysisSeconds\\\\\\\":0,\\\\\\\"readySeconds\\\\\\\":0,\\\\\\\"wikiType\\\\\\\":null,\\\\\\\"others\\\\\\\":null,\\\\\\\"skillIds\\\\\\\":null,\\\\\\\"weighted\\\\\\\":null,\\\\\\\"additions\\\\\\\":null,\\\\\\\"answers\\\\\\\":[[]],\\\\\\\"tags\\\\\\\":[]},\\\\\\\"analysisSeconds\\\\\\\":0,\\\\\\\"readySeconds\\\\\\\":0,\\\\\\\"id\\\\\\\":\\\\\\\"Q_10304365781566-3\\\\\\\",\\\\\\\"subjectId\\\\\\\":103,\\\\\\\"resourceIds\\\\\\\":null,\\\\\\\"resources\\\\\\\":[],\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":null,\\\\\\\"pids\\\\\\\":null,\\\\\\\"paragraph\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"articleName\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"answerWay\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"contentTypeId\\\\\\\":1032000,\\\\\\\"contentSubtypeId\\\\\\\":1032010,\\\\\\\"difficultyLevel\\\\\\\":1,\\\\\\\"difficultyDescription\\\\\\\":\\\\\\\"易\\\\\\\",\\\\\\\"complexFlag\\\\\\\":false,\\\\\\\"nid\\\\\\\":null,\\\\\\\"mainContent\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"analysis\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"contentDesc\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"additions\\\\\\\":{},\\\\\\\"description\\\\\\\":\\\\\\\"全文朗读\\\\\\\",\\\\\\\"seconds\\\\\\\":23,\\\\\\\"notFitMobile\\\\\\\":false,\\\\\\\"subQuestions\\\\\\\":[{\\\\\\\"indexP\\\\\\\":-1,\\\\\\\"indexR\\\\\\\":-1,\\\\\\\"indexQ\\\\\\\":0,\\\\\\\"seq\\\\\\\":-1,\\\\\\\"id\\\\\\\":\\\\\\\"Q_10304365781566-3-0\\\\\\\",\\\\\\\"oralVO\\\\\\\":{\\\\\\\"rawData\\\\\\\":{\\\\\\\"seconds\\\\\\\":null,\\\\\\\"variables\\\\\\\":null,\\\\\\\"keywords\\\\\\\":null,\\\\\\\"options\\\\\\\":[{\\\\\\\"name\\\\\\\":null,\\\\\\\"text\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"seconds\\\\\\\":10,\\\\\\\"roleType\\\\\\\":null,\\\\\\\"cnText\\\\\\\":null,\\\\\\\"voiceText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"voiceTexts\\\\\\\":null,\\\\\\\"sentencePatterns\\\\\\\":null,\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":\\\\\\\"57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenSeconds\\\\\\\":\\\\\\\"2\\\\\\\",\\\\\\\"dialogRole\\\\\\\":null,\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"listenFile\\\\\\\":null,\\\\\\\"jsgf\\\\\\\":null,\\\\\\\"voiceStart\\\\\\\":null,\\\\\\\"voiceEnd\\\\\\\":null}],\\\\\\\"voiceText\\\\\\\":null,\\\\\\\"sentencePatterns\\\\\\\":null,\\\\\\\"picUrl\\\\\\\":null,\\\\\\\"picName\\\\\\\":null,\\\\\\\"beginListenUrl\\\\\\\":null,\\\\\\\"endListenUrl\\\\\\\":null,\\\\\\\"scorePercentage\\\\\\\":null,\\\\\\\"readySeconds\\\\\\\":null,\\\\\\\"listenFile\\\\\\\":null,\\\\\\\"contentDesc\\\\\\\":null,\\\\\\\"answers\\\\\\\":null,\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"jsgf\\\\\\\":null,\\\\\\\"videoUrl\\\\\\\":null,\\\\\\\"videoCoverUrl\\\\\\\":null,\\\\\\\"highlightPos\\\\\\\":null},\\\\\\\"beginListenUrl\\\\\\\":null,\\\\\\\"endListenUrl\\\\\\\":null,\\\\\\\"readySeconds\\\\\\\":null,\\\\\\\"scorePercentage\\\\\\\":null,\\\\\\\"contentDesc\\\\\\\":null,\\\\\\\"jsgf\\\\\\\":null,\\\\\\\"variables\\\\\\\":null,\\\\\\\"sentencePatterns\\\\\\\":null,\\\\\\\"keywords\\\\\\\":null,\\\\\\\"answers\\\\\\\":[],\\\\\\\"seconds\\\\\\\":null,\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"sentences\\\\\\\":[{\\\\\\\"name\\\\\\\":null,\\\\\\\"text\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"voiceTextsNew\\\\\\\":null,\\\\\\\"seconds\\\\\\\":10,\\\\\\\"roleType\\\\\\\":null}]},\\\\\\\"mainContent\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"typeId\\\\\\\":14,\\\\\\\"analysis\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"analysisList\\\\\\\":null,\\\\\\\"options\\\\\\\":[],\\\\\\\"hideOptionIndexFlag\\\\\\\":0,\\\\\\\"listenUrl\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"listenName\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"classifCategoryNames\\\\\\\":[],\\\\\\\"classifCategoryUrls\\\\\\\":[],\\\\\\\"keyAnswers\\\\\\\":[],\\\\\\\"keyAnswersMultiple\\\\\\\":[],\\\\\\\"canAnswer\\\\\\\":true,\\\\\\\"submitWays\\\\\\\":[3],\\\\\\\"photoPictureNum\\\\\\\":0,\\\\\\\"audioRecordNum\\\\\\\":0,\\\\\\\"optionType\\\\\\\":\\\\\\\"word\\\\\\\",\\\\\\\"answers\\\\\\\":[],\\\\\\\"item_id\\\\\\\":\\\\\\\"-0\\\\\\\",\\\\\\\"dialogRole\\\\\\\":\\\\\\\"Girl\\\\\\\",\\\\\\\"sentenceId\\\\\\\":218300240008011,\\\\\\\"cnText\\\\\\\":\\\\\\\"我需要一条新连衣裙。\\\\\\\",\\\\\\\"enText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"voiceText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"audioTime\\\\\\\":1805,\\\\\\\"wordWave\\\\\\\":0}],\\\\\\\"timeLimitation\\\\\\\":23000,\\\\\\\"files\\\\\\\":null,\\\\\\\"others\\\\\\\":{}},\\\\\\\"_id\\\\\\\":\\\\\\\"218300240008011\\\\\\\",\\\\\\\"dialogRole\\\\\\\":\\\\\\\"Girl\\\\\\\",\\\\\\\"wavePlayTime\\\\\\\":1805,\\\\\\\"waveFileLocator\\\\\\\":\\\\\\\"http://cdn.17zuoye.com/fs-resource/57e2ca0c2ed9b65fd27f5178.sy3\\\\\\\",\\\\\\\"en\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"cn\\\\\\\":\\\\\\\"我需要一条新连衣裙。\\\\\\\",\\\\\\\"voiceText\\\\\\\":\\\\\\\"I need a new dress .\\\\\\\",\\\\\\\"isWordWave\\\\\\\":0,\\\\\\\"finalScore\\\\\\\":0,\\\\\\\"playBtn\\\\\\\":\\\\\\\"wait\\\\\\\",\\\\\\\"micBtn\\\\\\\":\\\\\\\"disable\\\\\\\",\\\\\\\"title\\\\\\\":\\\\\\\"blank\\\\\\\",\\\\\\\"time\\\\\\\":3,\\\\\\\"timeBar\\\\\\\":\\\\\\\"100%\\\\\\\",\\\\\\\"showMark\\\\\\\":false,\\\\\\\"retryCount\\\\\\\":5,\\\\\\\"index\\\\\\\":1,\\\\\\\"face\\\\\\\":0,\\\\\\\"tempFace\\\\\\\":0,\\\\\\\"retrySubjectCount\\\\\\\":5,\\\\\\\"_tempVoiceID\\\\\\\":\\\\\\\"915e64b2-4739-4e42-986a-95c17f9607d3\\\\\\\"}\\\",\\\"voiceID\\\":\\\"915e64b2-4739-4e42-986a-95c17f9607d3\\\",\\\"lessonId\\\":\\\"BKC_10300040084602\\\",\\\"practiceType\\\":91,\\\"homework_type\\\":\\\"ENGLISH\\\",\\\"hw_progress\\\":\\\"8/10\\\"}\",\"forwarded_ip\":\"223.88.29.97\",\"html_version\":\"V2_5_0\",\"ktwelve\":\"PRIMARY_SCHOOL\",\"memory\":\"288.890625/48.984375\",\"model\":\"iPhone8,2\",\"module\":\"voice\",\"msg\":\"{\\\"success\\\":true,\\\"id\\\":\\\"915e64b2-4739-4e42-986a-95c17f9607d3\\\",\\\"errMsg\\\":\\\"\\\",\\\"result\\\":{\\\"lines\\\":[{\\\"end\\\":1.941,\\\"pronunciation\\\":89.948,\\\"begin\\\":0,\\\"sample\\\":\\\"I need a new dress .\\\",\\\"score\\\":88.404,\\\"integrity\\\":100,\\\"usertext\\\":\\\"I need a new dress\\\",\\\"businessLevel\\\":\\\"1.5\\\",\\\"words\\\":[{\\\"end\\\":0.281,\\\"volume\\\":9,\\\"StressOfWord\\\":1,\\\"begin\\\":0.111,\\\"score\\\":9.132,\\\"subwords\\\":[{\\\"subtext\\\":\\\"'\\\",\\\"begin\\\":0.111,\\\"volume\\\":9,\\\"end\\\":0.281,\\\"score\\\":10},{\\\"subtext\\\":\\\"aɪ\\\",\\\"begin\\\":0.111,\\\"volume\\\":9,\\\"end\\\":0.281,\\\"score\\\":9.132}],\\\"phonetic\\\":\\\"'aɪ\\\",\\\"text\\\":\\\"I\\\",\\\"type\\\":2},{\\\"end\\\":0,\\\"volume\\\":0,\\\"begin\\\":0,\\\"score\\\":0,\\\"subwords\\\":[],\\\"text\\\":\\\" \\\",\\\"type\\\":7},{\\\"end\\\":0.701,\\\"volume\\\":9,\\\"StressOfWord\\\":1,\\\"begin\\\":0.281,\\\"score\\\":8.822,\\\"subwords\\\":[{\\\"subtext\\\":\\\"'\\\",\\\"begin\\\":0.281,\\\"volume\\\":9,\\\"end\\\":0.391,\\\"score\\\":10},{\\\"subtext\\\":\\\"n\\\",\\\"begin\\\":0.281,\\\"volume\\\":9,\\\"end\\\":0.391,\\\"score\\\":9.028},{\\\"subtext\\\":\\\"iː\\\",\\\"begin\\\":0.391,\\\"volume\\\":9,\\\"end\\\":0.601,\\\"score\\\":8.763},{\\\"subtext\\\":\\\"d\\\",\\\"begin\\\":0.601,\\\"volume\\\":9,\\\"end\\\":0.701,\\\"score\\\":8.837}],\\\"phonetic\\\":\\\"'niːd\\\",\\\"text\\\":\\\"need\\\",\\\"type\\\":2},{\\\"end\\\":0,\\\"volume\\\":0,\\\"begin\\\":0,\\\"score\\\":0,\\\"subwords\\\":[],\\\"text\\\":\\\" \\\",\\\"type\\\":7},{\\\"end\\\":0.841,\\\"volume\\\":9,\\\"StressOfWord\\\":0,\\\"begin\\\":0.701,\\\"score\\\":9.264,\\\"subwords\\\":[{\\\"subtext\\\":\\\"ʌ\\\",\\\"begin\\\":0.701,\\\"volume\\\":9,\\\"end\\\":0.841,\\\"score\\\":9.264}],\\\"phonetic\\\":\\\"ʌ\\\",\\\"text\\\":\\\"a\\\",\\\"type\\\":2},{\\\"end\\\":0,\\\"volume\\\":0,\\\"begin\\\":0,\\\"score\\\":0,\\\"subwords\\\":[],\\\"text\\\":\\\" \\\",\\\"type\\\":7},{\\\"end\\\":1.241,\\\"volume\\\":8.007,\\\"StressOfWord\\\":1,\\\"begin\\\":0.841,\\\"score\\\":9.086,\\\"subwords\\\":[{\\\"subtext\\\":\\\"'\\\",\\\"begin\\\":0.841,\\\"volume\\\":6.021,\\\"end\\\":1.001,\\\"score\\\":10},{\\\"subtext\\\":\\\"n\\\",\\\"begin\\\":0.841,\\\"volume\\\":9,\\\"end\\\":1.001,\\\"score\\\":9.648},{\\\"subtext\\\":\\\"j\\\",\\\"begin\\\":1.001,\\\"volume\\\":9,\\\"end\\\":1.101,\\\"score\\\":9.98},{\\\"subtext\\\":\\\"uː\\\",\\\"begin\\\":1.101,\\\"volume\\\":6.021,\\\"end\\\":1.241,\\\"score\\\":7.864}],\\\"phonetic\\\":\\\"'njuː\\\",\\\"text\\\":\\\"new\\\",\\\"type\\\":2},{\\\"end\\\":0,\\\"volume\\\":0,\\\"begin\\\":0,\\\"score\\\":0,\\\"subwords\\\":[],\\\"text\\\":\\\" \\\",\\\"type\\\":7},{\\\"end\\\":1.941,\\\"volume\\\":5.864,\\\"StressOfWord\\\":1,\\\"begin\\\":1.271,\\\"score\\\":9.194,\\\"subwords\\\":[{\\\"subtext\\\":\\\"'\\\",\\\"begin\\\":1.271,\\\"volume\\\":5.649,\\\"end\\\":1.421,\\\"score\\\":10},{\\\"subtext\\\":\\\"dr\\\",\\\"begin\\\":1.271,\\\"volume\\\":8.356,\\\"end\\\":1.421,\\\"score\\\":9.703},{\\\"subtext\\\":\\\"e\\\",\\\"begin\\\":1.421,\\\"volume\\\":5.649,\\\"end\\\":1.641,\\\"score\\\":9.292},{\\\"subtext\\\":\\\"s\\\",\\\"begin\\\":1.641,\\\"volume\\\":1.093,\\\"end\\\":1.941,\\\"score\\\":9.005}],\\\"phonetic\\\":\\\"'dres\\\",\\\"text\\\":\\\"dress\\\",\\\"type\\\":2},{\\\"end\\\":0,\\\"volume\\\":0,\\\"begin\\\":0,\\\"score\\\":0,\\\"subwords\\\":[],\\\"text\\\":\\\" .\\\",\\\"type\\\":7}],\\\"fluency\\\":59.061,\\\"standardScore\\\":6}],\\\"score\\\":88.404,\\\"url\\\":\\\"https://edu.hivoice.cn/WebAudio-1.0-SNAPSHOT/audio/play/1B600DDD-3803-4FB3-8196-D1F8DD8B0473/1514353293517463755/bj\\\",\\\"EvalType\\\":\\\"general\\\",\\\"version\\\":\\\"full 1.0\\\"},\\\"errCode\\\":\\\"\\\"}\",\"native_version\":\"2.9.3.733\",\"native_version_code\":\"733\",\"network\":\"wifi\",\"op\":\"record_complete\",\"os\":\"ios\",\"server_type\":\"prod\",\"session_id\":\"1514351330438\",\"system_version\":\"11.0.3\",\"time\":\"2017-12-27 13:41:36:436\",\"type\":\"log_normal\",\"use_proxy\":\"true\",\"user_agent\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0_3 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Mobile/15A432 17Student iOS 2.9.3.733 PRIMARY_SCHOOL\",\"userid\":\"372882134\",\"uuid\":\"179D350A-1C0D-49FB-8DDA-C0AB6DDF0E13\",\"wifi_info\":{\"BSSID\":\"dc:fe:18:61:34:d3\",\"SSID\":\"TP-LINK_34D3\"}}";
        message.add(line.getBytes());
        message.add(line.getBytes());
        message.add(line.getBytes());
    }

    @Test
    public void testWrite() {
        producer.sendBytes("app.test1", message);
    }


    @Test
    public void testWriteCallBack() {
        long startTime = System.currentTimeMillis();
        producer.sendBytes("app.test1", message, new SinkCallback(startTime));
    }

    @After
    public void stop() {
        producer.stop();
    }
}
